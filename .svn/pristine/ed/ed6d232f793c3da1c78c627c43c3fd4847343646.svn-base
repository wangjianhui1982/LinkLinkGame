import BaseComponent from "../../Script/BaseComponent";
import { Wzhcq_StorageName } from "../../Script/Enum";
import { Utils } from "../../Script/Utils";
import ExtScrollView from "./ExtScrollView";
import tujianItem from "./tujianItem";

const { ccclass, property } = cc._decorator;

@ccclass
export default class TuJian extends BaseComponent {

    @property(cc.Label)
    numLabel: cc.Label = null;

    @property(ExtScrollView)
    scrollview: ExtScrollView = null;

    level = 0;

    onLoad() {

    }

    start() {

    }

    protected onEnable(): void {
        this.initUI();
    }

    initUI() {
        this.level = Utils.getInstance.Wzhcq_getItem(Wzhcq_StorageName.boardIndex);
        this.numLabel.string = "" + this.level + "/200";

        let MaxLv = this.level + 1;
        let count = Math.ceil(MaxLv / 3);
        let cur = Math.floor(this.level / 3);
        let dataList = [];

        for (var i = 0; i < count; i++) {
            dataList.push(0);
        }
        if (this.scrollview.content.childrenCount <= 0) {
            this.scrollview.loadData(dataList, count - cur - 1, undefined)
        }
        else {
            this.scrollview.content.children.forEach(function (node) {
                node.getComponent(tujianItem).Refresh();
            });
        }

    }

    clickBtn() {
        this.EventMgr.emit(this.EventMgr.Wzhcq_EVENT_NAMES.Wzhcq_GAME_TIPS, "毛线不足");
    }

    closeBtn() {
        this.node.active = false;
    }
}
